All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y))
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
All_data <- All_data %>%
filter(`Watershed #` > 1)
All_data <- All_data %>%
mutate(DeltaQf_perc = ifelse(`Watershed #` == 76,157,DeltaQf_perc))
png("DataExploration.png", width = 2500, height = 1800, res = 300)
All_data %>%
pivot_longer(c(DeltaF_perc, DeltaQf_perc, Area_km2, Pa_mm, E0),
names_to = "variable", values_to = "value") %>%
ggplot(aes(value)) + geom_histogram(fill = "steelblue", bins=50) + theme_bw() +
facet_wrap(~variable, scales = "free", labeller = labeller(variable =
c("Area_km2" = "Area (km2)",
"DeltaF_perc" = "Delta Forest (%)",
"DeltaQf_perc" = "Delta Flow (%)",
"E0" = "Annual Potential E (mm)",
"Pa_mm" = "Annual Rainfall (mm)"))) +
theme(axis.title = element_text(size = rel(2)),
axis.text = element_text(size = rel(1.5)),
axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
All_data2 <- All_data %>%
mutate(Forest_Sign = ifelse(DeltaF_perc < 0,
"decrease", "increase"),
DeltaF_perc_pos = ifelse(DeltaF_perc < 0,
-1*DeltaF_perc,
DeltaF_perc))
# plot to show the difference
png("Increase_decrease.png", width = 2500, height = 1800, res = 300)
All_data2 %>%
ggplot(aes(DeltaF_perc_pos,DeltaQf_perc, colour = Forest_Sign)) +
geom_point() +
facet_wrap(~Forest_Sign, ncol=1, scales = "free") +
theme_bw() + scale_colour_manual(name = "direction of forest change", values = c("increase" = "blue", "decrease" = "red")) +
xlab("Change in forest cover %") + ylab("Change in flow %")
dev.off()
linear_model_simple <- gam(DeltaQf_perc ~ DeltaF_perc_pos +
Forest_Sign,
data = Data_all2 %>% filter(dataset == "original Zhang et al data"))
#summary(linear_model_simple)
#gam.check(linear_model_simple)
pander(round(summary(linear_model_simple)$p.table,2), caption="Summary results of the first regression model predicting change in streamflow from change in forest cover and accounting for the direction of the change")
linear_model_simple_b <- gam(DeltaQf_perc ~ DeltaF_perc_pos +
Forest_Sign,
data = Data_all2)
#summary(linear_model_simple)
#gam.check(linear_model_simple)
linear_model_simple <- gam(DeltaQf_perc ~ DeltaF_perc_pos +
Forest_Sign,
data = All_data2 %>% filter(dataset == "original Zhang et al data"))
#summary(linear_model_simple)
#gam.check(linear_model_simple)
pander(round(summary(linear_model_simple)$p.table,2), caption="Summary results of the first regression model predicting change in streamflow from change in forest cover and accounting for the direction of the change")
linear_model_simple_b <- gam(DeltaQf_perc ~ DeltaF_perc_pos +
Forest_Sign,
data = All_data2)
#summary(linear_model_simple)
#gam.check(linear_model_simple)
pander(round(summary(linear_model_simple_b)$p.table,2), caption="Summary results of the first regression model predicting change in streamflow from change in forest cover and accounting for the direction of the change including the new data sets")
linear_model2 <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + log10(Area_km2) + Pa_mm, data = All_data2)
#summary(linear_model2)
#gam.check(linear_model2)
pander(round(summary(linear_model2)$p.table,2), caption="Summary of the second model, taking into account the annual rainfall and the area of the watershed")
summary(linear_model2)
gam.check(linear_model2)
model3_includeLatLong <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + log10(Area_km2) + Pa_mm + Latitude + Longitude, data = All_data2)
#summary(model3_includeLatLong)
#gam.check(model3_includeLatLong)
View(All_data2)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) %>%
rename(Latitude.x = Latitude,
Longitude.x = Longitude)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) %>%
rename(Latitude = Latitude.x,
Longitude = Longitude.x)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small) %>%
mutate(dataet = "original Zhang et al data")
new_data <- new_data %>%
mutate(dataset = "new data")
All_data <- bind_rows(Zhang_all, new_data)
All_data <- All_data %>%
mutate(`Possible duplicate` =
ifelse(is.na(`Possible duplicate`)==T,0,`Possible duplicate`),
`Possible duplicate` = as.numeric(`Possible duplicate`)) %>%
filter(`Possible duplicate` != 1)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) %>%
rename(Latitude = Latitude.x,
Longitude = Longitude.x)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
require(tidyverse)
require(lubridate)
require(mgcv)
suppressWarnings(require(knitr))
suppressWarnings(require(bookdown))
suppressWarnings(require(pander))
Zhang_small <- read_csv("../../data/TablesZhangetal2017_small.csv")
Zhang_large <- read_csv("../../data/TablesZhangetal2017_large.csv") %>%
mutate(Complete = 1,
`Possible duplicate` = 0)
new_data <- read_csv("../../data/TableNewData.csv")
names(Zhang_small)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_large)[3:4] <- c("Area_km2", "Pa_mm")
names(new_data)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_small)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_large)[5:6] <- c("Forest_type", "Hydrological_regime")
names(new_data)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_small)[9:10] <- c("Precip_data_type", "Assessment_technique")
names(Zhang_large)[9:10] <- c("Precip_data_type", "Assessment_technique")
names(new_data)[9:10] <- c("Precip_data_type", "Assessment_technique")
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small) %>%
mutate(dataet = "original Zhang et al data")
new_data <- new_data %>%
mutate(dataset = "new data")
All_data <- bind_rows(Zhang_all, new_data)
All_data <- All_data %>%
mutate(`Possible duplicate` =
ifelse(is.na(`Possible duplicate`)==T,0,`Possible duplicate`),
`Possible duplicate` = as.numeric(`Possible duplicate`)) %>%
filter(`Possible duplicate` != 1)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) %>%
rename(Latitude = Latitude.x,
Longitude = Longitude.x)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) #%>%
#rename(Latitude = Latitude.x,
Longitude = Longitude.x)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
View(All_data)
All_data <- All_data %>%
filter(`Watershed #` > 1)
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small) %>%
mutate(dataet = "original Zhang et al data")
new_data <- new_data %>%
mutate(dataset = "new data")
All_data <- bind_rows(Zhang_all, new_data)
All_data <- All_data %>%
mutate(`Possible duplicate` =
ifelse(is.na(`Possible duplicate`)==T,0,`Possible duplicate`),
`Possible duplicate` = as.numeric(`Possible duplicate`)) %>%
filter(`Possible duplicate` != 1)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) #%>%
#rename(Latitude = Latitude.x,
#         Longitude = Longitude.x)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
All_data <- All_data %>%
filter(`Watershed #` != 1)
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small) %>%
mutate(dataet = "original Zhang et al data")
new_data <- new_data %>%
mutate(dataset = "new data")
All_data <- bind_rows(Zhang_all, new_data)
All_data <- All_data %>%
mutate(`Possible duplicate` =
ifelse(is.na(`Possible duplicate`)==T,0,`Possible duplicate`),
`Possible duplicate` = as.numeric(`Possible duplicate`)) %>%
filter(`Possible duplicate` != 1)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) #%>%
#rename(Latitude = Latitude.x,
#         Longitude = Longitude.x)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
All_data %>% filter(`Watershed #` == 1)
All_data %>% filter(`Watershed #` < 2)
All_data %>% filter(`Watershed #` > 1)
View(All_data)
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small) %>%
mutate(dataset = "original Zhang et al data")
new_data <- new_data %>%
mutate(dataset = "new data")
All_data <- bind_rows(Zhang_all, new_data)
All_data <- All_data %>%
mutate(`Possible duplicate` =
ifelse(is.na(`Possible duplicate`)==T,0,`Possible duplicate`),
`Possible duplicate` = as.numeric(`Possible duplicate`)) %>%
filter(`Possible duplicate` != 1)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) #%>%
#rename(Latitude = Latitude.x,
#         Longitude = Longitude.x)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
All_data <- All_data %>%
filter(`Watershed #` != 1)
View(All_data)
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small) %>%
mutate(dataset = "original Zhang et al data")
new_data <- new_data %>%
mutate(dataset = "new data")
All_data <- bind_rows(Zhang_all, new_data)
View(All_data)
require(tidyverse)
require(lubridate)
require(mgcv)
suppressWarnings(require(knitr))
suppressWarnings(require(bookdown))
suppressWarnings(require(pander))
Zhang_small <- read_csv("../../data/TablesZhangetal2017_small.csv")
Zhang_large <- read_csv("../../data/TablesZhangetal2017_large.csv") %>%
mutate(Complete = 1,
`Possible duplicate` = 0)
new_data <- read_csv("../../data/TableNewData.csv")
names(Zhang_small)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_large)[3:4] <- c("Area_km2", "Pa_mm")
names(new_data)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_small)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_large)[5:6] <- c("Forest_type", "Hydrological_regime")
names(new_data)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_small)[9:10] <- c("Precip_data_type", "Assessment_technique")
names(Zhang_large)[9:10] <- c("Precip_data_type", "Assessment_technique")
names(new_data)[9:10] <- c("Precip_data_type", "Assessment_technique")
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small) %>%
mutate(dataset = "original Zhang et al data")
new_data <- new_data %>%
mutate(dataset = "new data")
All_data <- bind_rows(Zhang_all, new_data)
All_data <- All_data %>%
mutate(`Possible duplicate` =
ifelse(is.na(`Possible duplicate`)==T,0,`Possible duplicate`),
`Possible duplicate` = as.numeric(`Possible duplicate`)) %>%
filter(`Possible duplicate` != 1)
require(tidyverse)
require(lubridate)
require(mgcv)
suppressWarnings(require(knitr))
suppressWarnings(require(bookdown))
suppressWarnings(require(pander))
Zhang_small <- read_csv("../../data/TablesZhangetal2017_small.csv")
Zhang_large <- read_csv("../../data/TablesZhangetal2017_large.csv") %>%
mutate(Complete = 1,
`Possible duplicate` = 0)
new_data <- read_csv("../../data/TableNewData.csv")
names(Zhang_small)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_large)[3:4] <- c("Area_km2", "Pa_mm")
names(new_data)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_small)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_large)[5:6] <- c("Forest_type", "Hydrological_regime")
names(new_data)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_small)[9:10] <- c("Precip_data_type", "Assessment_technique")
names(Zhang_large)[9:10] <- c("Precip_data_type", "Assessment_technique")
names(new_data)[9:10] <- c("Precip_data_type", "Assessment_technique")
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small) %>%
mutate(dataset = "original Zhang et al data")
new_data <- new_data %>%
mutate(dataset = "new data")
All_data <- bind_rows(Zhang_all, new_data)
All_data <- All_data %>%
mutate(`Possible duplicate` =
ifelse(is.na(`Possible duplicate`)==T,0,`Possible duplicate`),
`Possible duplicate` = as.numeric(`Possible duplicate`)) %>%
filter(`Possible duplicate` != 1)
All_data <- left_join(All_data ,PET_all %>% select(-c(Longitude, Latitude)), by = "Watershed #")
All_data <- All_data %>%
mutate(E0 = ifelse(is.na(E0.x)==T, E0.y, E0.x)) %>%
select(-c(E0.x,E0.y)) #%>%
#rename(Latitude = Latitude.x,
#         Longitude = Longitude.x)
# calculate dryness index
All_data <- All_data %>%
mutate(Dryness = E0/Pa_mm)
All_data <- All_data %>%
filter(`Watershed #` != 1)
All_data <- All_data %>%
mutate(DeltaQf_perc = ifelse(`Watershed #` == 76,157,DeltaQf_perc))
png("DataExploration.png", width = 2500, height = 1800, res = 300)
All_data %>%
pivot_longer(c(DeltaF_perc, DeltaQf_perc, Area_km2, Pa_mm, E0),
names_to = "variable", values_to = "value") %>%
ggplot(aes(value)) + geom_histogram(fill = "steelblue", bins=50) + theme_bw() +
facet_wrap(~variable, scales = "free", labeller = labeller(variable =
c("Area_km2" = "Area (km2)",
"DeltaF_perc" = "Delta Forest (%)",
"DeltaQf_perc" = "Delta Flow (%)",
"E0" = "Annual Potential E (mm)",
"Pa_mm" = "Annual Rainfall (mm)"))) +
theme(axis.title = element_text(size = rel(2)),
axis.text = element_text(size = rel(1.5)),
axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
All_data2 <- All_data %>%
mutate(Forest_Sign = ifelse(DeltaF_perc < 0,
"decrease", "increase"),
DeltaF_perc_pos = ifelse(DeltaF_perc < 0,
-1*DeltaF_perc,
DeltaF_perc))
# plot to show the difference
png("Increase_decrease.png", width = 2500, height = 1800, res = 300)
All_data2 %>%
ggplot(aes(DeltaF_perc_pos,DeltaQf_perc, colour = Forest_Sign)) +
geom_point() +
facet_wrap(~Forest_Sign, ncol=1, scales = "free") +
theme_bw() + scale_colour_manual(name = "direction of forest change", values = c("increase" = "blue", "decrease" = "red")) +
xlab("Change in forest cover %") + ylab("Change in flow %")
dev.off()
linear_model_simple <- gam(DeltaQf_perc ~ DeltaF_perc_pos +
Forest_Sign,
data = All_data2 %>% filter(dataset == "original Zhang et al data"))
#summary(linear_model_simple)
#gam.check(linear_model_simple)
linear_model_simple_b <- gam(DeltaQf_perc ~ DeltaF_perc_pos +
Forest_Sign,
data = All_data2)
#summary(linear_model_simple)
#gam.check(linear_model_simple)
pander(round(summary(linear_model_simple)$p.table,2), caption="Summary results of the first regression model predicting change in streamflow from change in forest cover and accounting for the direction of the change")
pander(round(summary(linear_model_simple_b)$p.table,2), caption="Summary results of the first regression model predicting change in streamflow from change in forest cover and accounting for the direction of the change including the new data sets")
linear_model2 <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + log10(Area_km2) + Pa_mm, data = All_data2)
#summary(linear_model2)
#gam.check(linear_model2)
pander(round(summary(linear_model2)$p.table,2), caption="Summary of the second model, taking into account the annual rainfall and the area of the watershed")
round(summary(linear_model2)$p.table[4,5],2)
round(summary(linear_model2)$p.table,2)
round(summary(linear_model2)$p.table[4,4],2)
pander(round(summary(model3_includeLatLong)$p.table,2), caption= "Results of the model including Latitude and Longitude")
model3_includeLatLong <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + log10(Area_km2) + Pa_mm + Latitude + Longitude, data = All_data2)
#summary(model3_includeLatLong)
#gam.check(model3_includeLatLong)
pander(round(summary(model3_includeLatLong)$p.table,2), caption= "Results of the model including Latitude and Longitude including new data")
pander(round(summary(model3_includeLatLong)$p.table,2), caption= "Results of the model including Latitude and Longitude including new data")
summary(model3_includeLatLong
)
#Zhang_all2 <- Zhang_all2 %>%
#  mutate(length = To - From)
model4_dryness <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + log10(Area_km2) +
Latitude + Longitude + Dryness, data = Zhang_all2)
#summary(model4_dryness)
#gam.check(model4_dryness)
pander(round(summary(model4_dryness)$p.table,2), caption = "Results of the model replacing the annual precipitation with the dryness index")
#Zhang_all2 <- Zhang_all2 %>%
#  mutate(length = To - From)
model4_dryness <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + log10(Area_km2) +
Latitude + Longitude + Dryness, data = All_data2)
#summary(model4_dryness)
#gam.check(model4_dryness)
pander(round(summary(model4_dryness)$p.table,2), caption = "Results of the model replacing the annual precipitation with the dryness index")
#Zhang_all2 <- Zhang_all2 %>%
#  mutate(length = To - From)
model4_dryness <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + log10(Area_km2) +
Dryness, data = All_data2)
#summary(model4_dryness)
#gam.check(model4_dryness)
#Zhang_all2 <- Zhang_all2 %>%
#  mutate(length = To - From)
model4_dryness <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + log10(Area_km2) +
Dryness, data = All_data2)
#summary(model4_dryness)
#gam.check(model4_dryness)
pander(round(summary(model4_dryness)$p.table,2), caption = "Results of the model replacing the annual precipitation with the dryness index")
pander(round(summary(model3_includeLatLong)$p.table,2), caption= "Results of the model including Latitude and Longitude including new data")
pander(round(summary(model4_dryness)$p.table,2), caption = "Results of the model replacing the annual precipitation with the dryness index")
Zhang_all2 <- Zhang_all2 %>%
mutate(length = To - From)
model5_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(log10(Area_km2), bs="ts") + s(Dryness, bs="ts") +
s(length, bs="ts") + s(Latitude, bs = "ts") ,
data = Zhang_all2)
summary(model5_all)
#gam.check(model5_all)
#plot(model5_all)
pander(round(summary(model5_all)$p.table,2))
pander(round(summary(model5_all)$s.table,2))
All_data2 <- All_data2 %>%
mutate(length = To - From)
model5_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(log10(Area_km2), bs="ts") + s(Dryness, bs="ts") +
s(length, bs="ts") ,
data = All_data2)
summary(model5_all)
#gam.check(model5_all)
#plot(model5_all)
pander(round(summary(model5_all)$p.table,2))
pander(round(summary(model5_all)$s.table,2))
plot(model5_all)
model6_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(log10(Area_km2), bs="ts") + s(Dryness, bs="ts" ) +
s(Latitude, bs="ts" ) +  s(length, bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime
, data = All_data2)
summary(model6_all)
#gam.check(model6_all)
#plot(model6_all)
plot(model6_all)
model6_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(log10(Area_km2), bs="ts") + s(Dryness, bs="ts" ) +
s(length, bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime
, data = All_data2)
summary(model6_all)
#gam.check(model6_all)
#plot(model6_all)
plot(model6_all)
model6_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(log10(Area_km2), bs="ts") + s(Dryness, bs="ts" ) +
s(length, bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime
, data = All_data2)
summary(model6_all)
#gam.check(model6_all)
#plot(model6_all)
?gam.plot
?plot.gam
model6_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(log10(Area_km2), bs="ts") + s(Dryness, bs="ts" ) +
s(length, bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime
, data = All_data2)
#summary(model6_all)
#gam.check(model6_all)
#plot(model6_all)
pander(round(summary(model6_all)$p.table,2))
pander(round(summary(model6_all)$s.table,2))
plot(model6_all, select = 3)
plot(model6_all)
plot(model6_all, pages = 1)
model6_reduc <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" )  +
s(log10(Area_km2), bs="ts") +  length +
Assessment_technique +
Hydrological_regime, data = Zhang_all2)
summary(model6_reduc)
summary(model6_all)
All_data2 %>%
ggplot(aes(Assessment_technique, length)) +
geom_boxplot(colour = "blue") + theme_bw()
model7_noLatb <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) + #s(Latitude, bs="ts") +
s(Area_km2, bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = All_data2 %>% filter(Dryness < 4))
summary(model7_noLatb)
plot(model7_noLatb)
model7_noLatb <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) + #s(Latitude, bs="ts") +
s(Area_km2, bs="ts") + s(length,bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = All_data2 %>% filter(Dryness < 4))
model7_noLatb <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) + #s(Latitude, bs="ts") +
s(log10(Area_km2), bs="ts") + s(length,bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = All_data2 %>% filter(Dryness < 4))
summary(model7_noLatb)
plot(model7_noLatb)
model7_noLatb <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) + #s(Latitude, bs="ts") +
s(log10(Area_km2), bs="ts") + s(length,bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = All_data2 %>% filter(length< 60))
summary(model7_noLatb)
plot(model7_noLatb)
