}
# 1. split by site
sites <- unique(all_sp$name)
site_summary_FPAR<- map(sites, sat_sum_fun, all_sp, FPAR)
site_summary_AET<- map(sites, sat_sum_fun, all_sp, AET)
FPAR_all <- bind_rows(site_summary_FPAR)
AET_all <- bind_rows(site_summary_AET)
FPAR_all %>%
ggplot(aes(sapflow,fpar, colour = name)) + geom_point()
AET_all %>%
ggplot(aes(sapflow,aet, colour = name)) + geom_point()
# acf_data <- EVI_all %>%
#   group_by(name) %>%
#   nest() %>%
#   mutate(acf = map(data, function(x) {
#     ccf(x$sapflow,x$rain, na.action=na.pass)}))
AET_all %>%
ggplot(aes(sapflow*fc/100,aet, colour = name)) + geom_point()
AET_all %>%
ggplot(aes(sapflow,aet*fc/100, colour = name)) + geom_point()
all <- left_join(FPAR_all,AET_all)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet, colour = name)) + geom_point()
#png(filename="sapflow_aet.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet)) + geom_point() + geom_smooth(method="lm") +
facet_wrap(~name, scale="free")
#dev.off()
png(filename="sapflow_aet.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet)) + geom_point() + geom_smooth(method="lm") +
facet_wrap(~name, scale="free")
dev.off()
png(filename="sapflow_aet.png", width = 760, height = 760)
all %>%
#mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,aet)) + geom_point() + geom_smooth(method="lm") +
facet_wrap(~name, scale="free")
dev.off()
png(filename="sapflow_scaled_aet.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet)) + geom_point() + geom_smooth(method="lm") +
facet_wrap(~name, scale="free")
dev.off()
png(filename="sapflow_scaled_aet&rain.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet, colour=rain)) + geom_point() + geom_smooth(method="lm") +
facet_wrap(~name, scale="free")
dev.off()
png(filename="sapflow_scaled_aet&rain.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet, colour=log(rain))) + geom_point() + geom_smooth(method="lm") +
facet_wrap(~name, scale="free")
dev.off()
png(filename="sapflow_scaled_aet&rain.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet, colour=log(rain+1))) + geom_point() + geom_smooth(method="lm") +
facet_wrap(~name, scale="free")
dev.off()
png(filename="sapflow_scaled_aet&rain.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet - rain, colour=log(rain+1))) + geom_point() + geom_smooth(method="lm") +
facet_wrap(~name, scale="free")
dev.off()
png(filename="sapflow_scaled_aet&rain.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet - rain, colour=log(rain+1))) + geom_point() + geom_smooth(method="lm") + ylim(0,2) +
facet_wrap(~name, scale="free")
dev.off()
png(filename="sapflow_scaled_aet&rain.png", width = 760, height = 760)
png(filename="sapflow_scaled_aet&rain.png", width = 760, height = 760)
all %>%
mutate(scaled_aet = aet*fc/100) %>%
ggplot(aes(sapflow,scaled_aet, colour=log(rain+1))) + geom_point() + geom_smooth(method="lm") + #ylim(0,2) +
facet_wrap(~name, scale="free")
dev.off()
x <- seq(-32,32)
y <- x*5/9 -32
y
plot(x,y)
y <- x/5/9 -32
plot(x,y)
plot(x,y)
y <- x*5/9 -32
tf = tc*5/9 -32
tf = function(tc)
tc*5/9 -32
tf(-72)
tf = function(tc) {}
tf = function(tc) {
tc*5/9 -32}
tf(-72)
tf = function(tc) {
tc*9/5 -32}
tf(-40)
tc*5/9 + 32}
tf = function(tc) {
tc*5/9 + 32}
tf(-40)
tc*9/5 + 32}
tf = function(tc) {
tc*9/5 + 32}
tf(-40)
require(stats4)
require(stats4)
set.seed(1001)
N <- 100
x <- rnorm(N,mean = 3, sd = 2)
mean(x)
sd(x)
LL <- function(x, mu, sigma) {
# define probability distribution for a normal distribution
R = surpressWarnings(dnorm(x,mu,sigma))
#minus 1 * sum of logged values
-sum(log(R))
}
mle(LL, start=list(x=x, mu = 1, sigma =1)))
mle(LL, start=list(x=x, mu = 1, sigma =1))
mle(LL, start=list(mu = 1, sigma =1))
LL <- function(mu, sigma) {
# define probability distribution for a normal distribution
R = surpressWarnings(dnorm(x,mu,sigma))
#minus 1 * sum of logged values
-sum(log(R))
}
mle(LL, start=list(mu = 1, sigma =1))
LL <- function(mu, sigma) {
# define probability distribution for a normal distribution
R = suppressWarnings(dnorm(x,mu,sigma))
#minus 1 * sum of logged values
-sum(log(R))
}
mle(LL, start=list(mu = 1, sigma =1))
?pander
require(tidyverse)
require(lubridate)
require(mgcv)
suppressWarnings(require(knitr))
suppressWarnings(require(bookdown))
suppressWarnings(require(pander))
Zhang_small <- read_csv("../../data/TablesZhangetal2017_small.csv")
Zhang_large <- read_csv("../../data/TablesZhangetal2017_large.csv")
?pander
pander(round(summary(linear_model2)$p.table,2), caption="Summary of the second model, taking into account the annual rainfall and the area of the watershed")
# Chunk 1
require(tidyverse)
require(lubridate)
require(mgcv)
suppressWarnings(require(knitr))
suppressWarnings(require(bookdown))
suppressWarnings(require(pander))
Zhang_small <- read_csv("../../data/TablesZhangetal2017_small.csv")
Zhang_large <- read_csv("../../data/TablesZhangetal2017_large.csv")
# Chunk 2
PET_large <- read_csv("../../data/largeET.csv")
PET_small <- read_csv("../../data/smallET.csv")
# drop columns and make sure the titles are the same
PET_large <- PET_large %>%
rename(Latitude = Latitiude,
E0 = rvalue_1,
`Watershed #` = Watershed)
PET_small <- PET_small %>%
select(site_name, lat, long, rvalue_1) %>%
rename(Latitude = lat,
Longitude = long,
`Watershed #` = site_name,
E0 = rvalue_1)
#
PET_all <- bind_rows(PET_large, PET_small)
# There are 7 missing E0 values
# > PET_all$`Watershed #`[is.na(PET_all$E0)==T]
# [1]  38 278 269 243 236 299 250
# Chunk 5
names(Zhang_small)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_large)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_small)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_large)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_small)[9:10] <- c("Precip_data_type", "Assessment_technique")
names(Zhang_large)[9:10] <- c("Precip_data_type", "Assessment_technique")
# Chunk 6
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small)
# Chunk 7
Zhang_all <- left_join(Zhang_all %>% select(-c(E0, Longitude, Latitude)),PET_all, by = "Watershed #")
# calculate dryness index
Zhang_all <- Zhang_all %>%
mutate(Dryness = E0/Pa_mm)
# Chunk 8
Zhang_all <- Zhang_all %>%
filter(`Watershed #` > 1)
# Chunk 9
Zhang_all <- Zhang_all %>%
mutate(DeltaQf_perc = ifelse(`Watershed #` == 76,157,DeltaQf_perc))
# Chunk 11: data_graphs
include_graphics("DataExploration.png")
# Chunk 12
Zhang_all2 <- Zhang_all %>%
mutate(Forest_Sign = ifelse(DeltaF_perc < 0,
"decrease", "increase"),
DeltaF_perc_pos = ifelse(DeltaF_perc < 0,
-1*DeltaF_perc,
DeltaF_perc))
# Chunk 14: increase_decrease
include_graphics("Increase_decrease.png")
# Chunk 15: model1
linear_model_simple <- gam(DeltaQf_perc ~ DeltaF_perc_pos +
Forest_Sign,
data = Zhang_all2)
#summary(linear_model_simple)
#gam.check(linear_model_simple)
# Chunk 16
pander(round(summary(linear_model_simple)$p.table,2))
# Chunk 17: model2
linear_model2 <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + Area_km2 + Pa_mm, data = Zhang_all2)
#summary(linear_model2)
#gam.check(linear_model2)
setwd("C:/Users/rver4657/Dropbox (Sydney Uni)/Research/Forest_and_water/paper/Forest_and_Water")
# Chunk 1
require(tidyverse)
require(lubridate)
require(mgcv)
suppressWarnings(require(knitr))
suppressWarnings(require(bookdown))
suppressWarnings(require(pander))
Zhang_small <- read_csv("../../data/TablesZhangetal2017_small.csv")
Zhang_large <- read_csv("../../data/TablesZhangetal2017_large.csv")
# Chunk 2
PET_large <- read_csv("../../data/largeET.csv")
PET_small <- read_csv("../../data/smallET.csv")
# drop columns and make sure the titles are the same
PET_large <- PET_large %>%
rename(Latitude = Latitiude,
E0 = rvalue_1,
`Watershed #` = Watershed)
PET_small <- PET_small %>%
select(site_name, lat, long, rvalue_1) %>%
rename(Latitude = lat,
Longitude = long,
`Watershed #` = site_name,
E0 = rvalue_1)
#
PET_all <- bind_rows(PET_large, PET_small)
# There are 7 missing E0 values
# > PET_all$`Watershed #`[is.na(PET_all$E0)==T]
# [1]  38 278 269 243 236 299 250
# Chunk 5
names(Zhang_small)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_large)[3:4] <- c("Area_km2", "Pa_mm")
names(Zhang_small)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_large)[5:6] <- c("Forest_type", "Hydrological_regime")
names(Zhang_small)[9:10] <- c("Precip_data_type", "Assessment_technique")
names(Zhang_large)[9:10] <- c("Precip_data_type", "Assessment_technique")
# Chunk 6
Zhang_small$From <- as.numeric(Zhang_small$From)
Zhang_small$To <- as.numeric(Zhang_small$To)
Zhang_all <- bind_rows(Zhang_large,Zhang_small)
# Chunk 7
Zhang_all <- left_join(Zhang_all %>% select(-c(E0, Longitude, Latitude)),PET_all, by = "Watershed #")
# calculate dryness index
Zhang_all <- Zhang_all %>%
mutate(Dryness = E0/Pa_mm)
# Chunk 8
Zhang_all <- Zhang_all %>%
filter(`Watershed #` > 1)
# Chunk 9
Zhang_all <- Zhang_all %>%
mutate(DeltaQf_perc = ifelse(`Watershed #` == 76,157,DeltaQf_perc))
# Chunk 11: data_graphs
include_graphics("DataExploration.png")
# Chunk 12
Zhang_all2 <- Zhang_all %>%
mutate(Forest_Sign = ifelse(DeltaF_perc < 0,
"decrease", "increase"),
DeltaF_perc_pos = ifelse(DeltaF_perc < 0,
-1*DeltaF_perc,
DeltaF_perc))
# Chunk 14: increase_decrease
include_graphics("Increase_decrease.png")
# Chunk 15: model1
linear_model_simple <- gam(DeltaQf_perc ~ DeltaF_perc_pos +
Forest_Sign,
data = Zhang_all2)
#summary(linear_model_simple)
#gam.check(linear_model_simple)
# Chunk 16
pander(round(summary(linear_model_simple)$p.table,2), caption="Summary results of the first regression model predicting change in streamflow from change in forest cover and accounting for the direction of the change")
# Chunk 17: model2
linear_model2 <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + Area_km2 + Pa_mm, data = Zhang_all2)
#summary(linear_model2)
#gam.check(linear_model2)
# Chunk 18
pander(round(summary(linear_model2)$p.table,2), caption="Summary of the second model, taking into account the annual rainfall and the area of the watershed")
# Chunk 19: global_map
include_graphics("../../data/FAOET0data2.png")
# Chunk 20: model3
model3_includeLatLong <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + Area_km2 + Pa_mm + Latitude + Longitude, data = Zhang_all2)
#summary(model3_includeLatLong)
#gam.check(model3_includeLatLong)
# Chunk 21
pander(round(summary(model3_includeLatLong)$p.table,2), caption= "Results of the model including Latitude and Longitude")
# Chunk 22: model4
#Zhang_all2 <- Zhang_all2 %>%
#  mutate(length = To - From)
model4_dryness <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign + Area_km2 +
Latitude + Longitude + Dryness, data = Zhang_all2)
#summary(model4_dryness)
#gam.check(model4_dryness)
# Chunk 23
pander(round(summary(model4_dryness)$p.table,2), caption = "Results of the model replacing the annual precipitation with the dryness index")
# Chunk 24
pander(Zhang_all2 %>% filter(Dryness > 4) %>% select(Latitude, Longitude,`Watershed name`), caption = "Watersheds for which the dryness inddex > 4")
# Chunk 25: model5
Zhang_all2 <- Zhang_all2 %>%
mutate(length = To - From)
model5_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Area_km2, bs="ts") + s(Dryness, bs="ts") + s(length, bs="ts") +
Latitude ,  data = Zhang_all2)
summary(model5_all)
#gam.check(model5_all)
#plot(model5_all)
#pander(round(summary(model5_all)$p.table,2))
model6_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Area_km2, bs="ts") + s(Dryness, bs="ts" ) +
s(Latitude, bs="ts" ) +  s(length, bs="ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime
, data = Zhang_all2)
summary(model6_all)
#gam.check(model6_all)
#plot(model6_all)
Zhang_all2 <- Zhang_all2 %>%
mutate(length = To - From)
model5_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Area_km2, bs="ts") + s(Dryness, bs="ts") +
s(length, bs="ts") + s(Latitude, bs = "ts") ,
data = Zhang_all2)
summary(model5_all)
#gam.check(model5_all)
#plot(model5_all)
#pander(round(summary(model5_all)$p.table,2))
model7_noLat <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + s(length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = Zhang_all2)
summary(model7_noLat)
plot(model7_noLat)
gam.check(model7_noLat)
model7_noLat <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + s(length, k = 4, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = Zhang_all2)
summary(model7_noLat)
plot(model7_noLat)
model7_noLat <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + s(length, k = 5, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = Zhang_all2)
summary(model7_noLat)
plot(model7_noLat)
model7_noLat <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + s(length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = Zhang_all2)
summary(model7_noLat)
plot(model7_noLat)
?te
model7_noLat <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + te(Forest_Sign, length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = Zhang_all2)
summary(model7_noLat)
plot(model7_noLat)
model7_noLat <- gam(DeltaQf_perc ~ DeltaF_perc_pos + #Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + te(Forest_Sign, length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = Zhang_all2)
summary(model7_noLat)
plot(model7_noLat)
s(Area_km2, bs="ts")  + te(Forest_Sign, length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = Zhang_all2)
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + #Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + te(Forest_Sign, length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime, data = Zhang_all2)
str(Zhang_all2)
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + #Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + te(Forest_Sign, length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2 %>% mutate(Forest_Sign = as.numeric(Forest_Sign)))
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + #Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + te(Forest_Sign, length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2 %>% mutate(Forest_Sign = ifelse(Forest_Sign == "decrease",-1,1)))
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + #Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + te(Forest_Sign, length, k = 3 bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2 %>% mutate(Forest_Sign = ifelse(Forest_Sign == "decrease",-1,1)))
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + #Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + te(Forest_Sign, length, k = 3 bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2 %>% mutate(Forest_Sign = ifelse(Forest_Sign == "decrease",-1,1)))
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + #Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + te(Forest_Sign, length, k = 3, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2 %>% mutate(Forest_Sign = ifelse(Forest_Sign == "decrease",-1,1)))
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + s(length, bs = "tp") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
summary(model7_noLat_intlength)
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + s(length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
summary(model7_noLat_intlength)
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="tp" ) +
s(Area_km2, bs="tp")  + s(length, bs = "tp") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
summary(model7_noLat_intlength)
plot(model7_noLat_intlength)
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  + s(length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
summary(model7_noLat_intlength)
plot(model7_noLat_intlength)
Zhang_all2 %>%
ggplot(aes(DeltaQf_perc, length)) +
geom_point(colour = "blue") + theme_bw()
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="ts" ) +
s(Area_km2, bs="ts")  +# s(length, bs = "ts") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
summary(model7_noLat_intlength)
plot(model7_noLat_intlength)
s(Dryness, bs="cr" ) +
s(Area_km2, bs="cr")  + s(length, bs = "cr") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="cr" ) +
s(Area_km2, bs="cr")  + s(length, bs = "cr") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="cr" ) +
s(Area_km2, bs="cr")  + s(length, bs = "cr") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
summary(model7_noLat_intlength)
plot(model7_noLat_intlength)
model7_noLat_intlength <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Dryness, bs="tp" ) +
s(Area_km2, bs="tp")  + s(length, bs = "tp") +
Precip_data_type +  Assessment_technique + Forest_type +
Hydrological_regime,
data = Zhang_all2)
summary(model7_noLat_intlength)
plot(model7_noLat_intlength)
Zhang_all2 <- Zhang_all2 %>%
mutate(length = To - From)
model5_all <- gam(DeltaQf_perc ~ DeltaF_perc_pos + Forest_Sign +
s(Area_km2, bs="ts") + s(Dryness, bs="ts") +
s(length, bs="ts") + s(Latitude, bs = "ts") ,
data = Zhang_all2)
summary(model5_all)
#gam.check(model5_all)
#plot(model5_all)
#pander(round(summary(model5_all)$p.table,2))
str(summary(model5_all))
